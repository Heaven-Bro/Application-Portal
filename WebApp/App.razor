@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Authorization
@using Blazored.Toast.Configuration

<Router AppAssembly="@typeof(App).Assembly">
    <Found Context="routeData">
        <AuthorizeRouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)">
            <Authorizing>
                <div class="flex items-center justify-center min-h-screen">
                    <div class="text-center">
                        <div class="inline-block w-12 h-12 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin"></div>
                        <p class="mt-4 text-gray-600">Checking permissions...</p>
                    </div>
                </div>
            </Authorizing>
            <NotAuthorized>
                @if (context.User.Identity?.IsAuthenticated == true)
                {
                    <div class="flex items-center justify-center min-h-screen bg-gray-50">
                        <div class="text-center p-8 bg-white rounded-lg shadow-lg max-w-md">
                            <div class="text-6xl mb-4">🚫</div>
                            <h1 class="text-2xl font-bold text-[var(--error)] mb-2">Access Denied</h1>
                            <p class="text-gray-600 mb-6">You don't have permission to view this page.</p>
                            <a href="/" class="inline-block px-6 py-3 bg-blue-500 text-white rounded hover:bg-blue-600 transition">
                                Go to Homepage
                            </a>
                        </div>
                    </div>
                }
                else
                {
                    <RedirectToLogin />
                }
            </NotAuthorized>
        </AuthorizeRouteView>
        <FocusOnNavigate RouteData="@routeData" Selector="h1" />
    </Found>
    <NotFound>
        <PageTitle>404 - Not Found</PageTitle>
        <LayoutView Layout="@typeof(MainLayout)">
            <div class="flex items-center justify-center min-h-screen">
                <div class="text-center p-8">
                    <div class="text-8xl mb-4">🔍</div>
                    <h1 class="text-4xl font-bold mb-2">404</h1>
                    <p class=" mb-6 text-[var(--error)]">Sorry, there's nothing at this address.</p>
                    <a href="/" class="inline-block px-6 py-3 bg-[var(--surface)] text-white rounded-lg">
                        Go to Homepage
                    </a>
                </div>
            </div>
        </LayoutView>
    </NotFound>
</Router>

<BlazoredToasts Position="ToastPosition.TopRight" 
                Timeout="100" 
                />



@code {
    [CascadingParameter]
    private Task<AuthenticationState>? AuthenticationStateTask { get; set; }
}
