@if (TotalPages > 1)
{
    <div class="pagination-container">
        <div class="pagination-info font-text">
            Showing <strong>@GetStartItem()</strong> to <strong>@GetEndItem()</strong> of <strong>@TotalItems</strong> items
        </div>

        <div class="pagination-controls">
            <button class="pagination-btn" 
                    @onclick="@(() => ChangePage(1))" 
                    disabled="@(CurrentPage == 1)">
                <i>⏮️</i>
            </button>

            <button class="pagination-btn" 
                    @onclick="@(() => ChangePage(CurrentPage - 1))" 
                    disabled="@(CurrentPage == 1)">
                <i>◀️</i>
            </button>

            @for (int i = GetStartPage(); i <= GetEndPage(); i++)
            {
                int pageNumber = i;
                <button class="pagination-btn @(pageNumber == CurrentPage ? "active" : "")" 
                        @onclick="@(() => ChangePage(pageNumber))">
                    @pageNumber
                </button>
            }

            <button class="pagination-btn" 
                    @onclick="@(() => ChangePage(CurrentPage + 1))" 
                    disabled="@(CurrentPage == TotalPages)">
                <i>▶️</i>
            </button>

            <button class="pagination-btn" 
                    @onclick="@(() => ChangePage(TotalPages))" 
                    disabled="@(CurrentPage == TotalPages)">
                <i>⏭️</i>
            </button>
        </div>
    </div>
}

@code {
    [Parameter]
    public int CurrentPage { get; set; } = 1;

    [Parameter]
    public int TotalPages { get; set; }

    [Parameter]
    public int TotalItems { get; set; }

    [Parameter]
    public int PageSize { get; set; } = 10;

    [Parameter]
    public EventCallback<int> OnPageChanged { get; set; }

    private const int MaxVisiblePages = 5;

    private async Task ChangePage(int page)
    {
        if (page >= 1 && page <= TotalPages && page != CurrentPage)
        {
            await OnPageChanged.InvokeAsync(page);
        }
    }

    private int GetStartPage()
    {
        var half = MaxVisiblePages / 2;
        var start = Math.Max(1, CurrentPage - half);
        var end = Math.Min(TotalPages, start + MaxVisiblePages - 1);
        
        if (end - start < MaxVisiblePages - 1)
        {
            start = Math.Max(1, end - MaxVisiblePages + 1);
        }
        
        return start;
    }

    private int GetEndPage()
    {
        return Math.Min(TotalPages, GetStartPage() + MaxVisiblePages - 1);
    }

    private int GetStartItem()
    {
        return (CurrentPage - 1) * PageSize + 1;
    }

    private int GetEndItem()
    {
        return Math.Min(CurrentPage * PageSize, TotalItems);
    }
}
